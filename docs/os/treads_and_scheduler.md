## Процесс и тред(поток)

Процессы — это, по сути, выполняющиеся программы.

Треды (threads, потоки) — это легковесные "подзадачи", которые могут выполняться на ядрах процессора. У каждого процесса есть, как минимум,
один основной тред, и, при необходимости, N дополнительных. Тредов может быть очень много, но, очевидно, одновременно в каждый момент времени
может выполняться ровно столько, сколько у нас ядер.

Теперь возвращаемся к многозадачности процессора. Когда мы говорили, что ОС лихо переключается между "задачами", имитируя их одновременное
выпонение, имелось ввиду, что ОС просто переключает треды, которые выполняются на каждом ядре.

Всем этим безобразием заведует планировщик ОС.
————

На собеседованиях также любят спрашивать, чем процесс отличается от треда.

В таком случае, можете добавить, что процессы друг от друга изолированы, т.е. не имеют доступ к памяти друг друга. 
Более умным языком - каждый процесс работает в своём собственном виртуальном адресном пространстве, которое изолируется на уровне ОС.

В отличие от процессов, все треды внутри одного процесса делят между собой общую память и ресурсы, что позволяет им эффективно обмениваться
данными и синхронизироваться.

————

## Параллельность и конкурентность

Конкурентность это когда мы работаем со множеством вещей одновременно, а параллелизм — когда выполняем множество вещей одновременно.

А кто же занимается переключением задач и решает, какие из них будут выполняться на ядре, а какие подождут? Занимается этим планировщик операционной системы, и управляет он тредами.

**Тред (поток)** - это последовательность команд, которые выполняются в рамках одного процесса. Говоря простыми словами, это та работа, которая выполняется на процессоре, либо ждёт своей очереди.

Каждый тред может находиться в одном из трёх состояний:

*Executing*: выполняется прямо сейчас на одном из ядер

*Runnable*: готов к выполнению, дожидается своей очереди

*Waiting*: не готов к выполнению, так как ждёт какого-то события. Например, это может быть связано с i/o операцией, взаимодействием с ОС (syscall) и др.

### Переключение контекста

Планировщик ОС может в произвольные моменты времени переключать треды — отключать выполняющиеся от ядра процессора и заменять их Runnable тредами. 
Это называется переключением контекста (context switching). Мы никак не можем повлиять на решения планировщика,
как и не можем строить какие-то предсказания на этот счёт — все решения он принимает самостоятельно.
Такой подход называется вытесняющей многозадачностью (Preemptive multitasking).

### GMP - модель

Горутины - это легковесные потоки, если провести анологию то это маленькие треды, которыми заведует Планирощик GO, а не планировщик OS.

Также введем ещё 2 сущности:

- Машина для выполнения (M, Machine) — будет непосредственно выполнять горутину.
- Процессор (P, Processor) — будет помещать горутины (G) в Машину.

По сути, Машина — это просто системный тред. То есть, Процессор, помещая горутину в Машину, просто привязывает эту горутину к треду.

